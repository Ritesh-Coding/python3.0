{% extends 'base.html' %}
{% block title %} Job Application Form {% endblock %}

{% block body %}
<h1>Employee Registration Form</h1>
<form
     method="post" autocomplete="on" id="Form1">
{% csrf_token %}
{{step}}
<input type="hidden" name="step" value="{{ step }}">
{% comment %} <div class="stepIndicator">
    <div class="step">Basic Details</div>
    <div class="step">education Details</div>
    <span class="step">Work Experience</span>
    <span class="step">Languages Known</span>
    <span class="step">Technologies You Know</span>
    <span class="step">Reference</span>
    <span class="step">Preference</span>
  </div> {% endcomment %}
  {% if step == 1 %}
     <div class="tab">
    <fieldset id="basic_details">
        <table>
            <legend>Basic Details</legend>
            <tr>
                <td>
                    
                    <label for="firstname"> First name </label>
                    {{form.firstName}}
                    {% if form.errors.firstName %}
                    <p>{{form.errors.firstName}}</p>
                    {% endif %}
                </td>

                <td>
                    <label for="lastname"> Last name </label>
                    {{form.lastName}}
                    {% if form.errors.lastName %}
                    <p>{{form.errors.lastName}}</p>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>
                    <label for="email"> Email </label>
                    {{form.email}}
                    {% if form.errors.email %}
                    <p>{{form.errors.email}}</p>
                    {% endif %}
                </td>
                <td>
                    <label for="Designation"> Designation </label>
                    {{form.designation}}
                    {% if form.errors.designation %}
                    <p>{{form.errors.designation}}</p>
                    {% endif %}
                </td>

            </tr>
            <tr>
                <td>
                    <label for="Address1"> Address1 </label>
                    {{form.address1}}
                    {% if form.errors.address1 %}
                    <p>{{form.errors.address1}}</p>
                    {% endif %}
                </td>
                <td>
                    <label for="Address2"> Address2 </label>
                    {{form.address2}}
                    {% if form.errors.address2 %}
                    <p>{{form.errors.address2}}</p>
                    {% endif %}
                </td>
            </tr>

            <tr>
                <td>
                    <label for="Phone"> Phone Number </label>
                    {{form.phone}}
                    {% if form.errors.phone %}
                    <p>{{form.errors.phone}}</p>
                    {% endif %}
                </td>
                <td>
                    <label for="City"> City </label>
                    {{form.cities}}  
                    {% if form.errors.cities %}
                    <p>{{form.errors.cities}}</p>
                    {% endif %}
                </td>
            </tr>
            <tr rowspan="2">
                <td>
                    Gender
                    {{form.gender}}  
                    {% if form.errors.gender %}
                    <p>{{form.errors.gender}}</p>
                    {% endif %}
                </td>
                <td>
                    <label for="states">States:</label>
                    {{form.states}}
                    {% if form.errors.states %}
                    <p>{{form.errors.states}}</p>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <label for="Zipcode"> Zip code </label>
                    {{form.zip}}
                    {% if form.errors.zip %}
                    <p>{{form.errors.zip}}</p>
                    {% endif %}
                </td>
            </tr>

            <tr>
                <td>
                    Relationship status
                    {{form.relationship}}
                    {% if form.errors.relationship %}
                    <p>{{form.errors.relationship}}</p>
                    {% endif %}
                </td>
                <td>
                    <label for="dateofbirth"> Date of Birth</label>
                    {{form.date_of_birth}}
                    {% if form.errors.date_of_birth %}
                    <p>{{form.errors.date_of_birth}}</p>
                    {% endif %}
                </td>
            </tr>

        </table>
    </fieldset>
    <button type="submit">Next</button>
</div> 

{% elif step == 2 %}
 <div class="tab">
    <fieldset>
        <legend>Educational Details</legend>
        <input type="button" onclick="add_Rows()" value="+"></button>         
        <input type="button" onclick="subtractRows()" value="-"></button>
        <table id="education_table" class="table">
            <tbody id="education_body">
                {% if form.errors.name_of_board %}
                <p>{{form.errors.name_of_board}}</p>
            {% endif %}
            {% if form.errors.passing_year %}
                        <p>{{form.errors.passing_year}}</p>
                    {% endif %}
                    {% if form.errors.percentage %}
                    <p>{{form.errors.percentage}}</p>
                {% endif %}
                <tr id="dynamic_row">
                    <td>
                        <label class="label" for="board_name">Name of Board</label>
                        
                        {{form.name_of_board}}
                       
                        <label class="label" for="passing_year">Passing Year</label>
                        {{form.passing_year}}
                        
                        <label class="label" for="percentage">Percentage</label>
                        {{form.percentage}}
                       
                    </td>
                </tr>
            </tbody>
        </table>
    </fieldset>
    <button type="submit" name="previous">Previous</button>
        <button type="submit">Next</button>
    </div> 
{% elif step == 3 %}
 <div class="tab">
    <fieldset>
        <legend>Work Experience</legend>
        <input type="button" onclick="experience_addRow()" value="+"></button>                   
        <input type="button" onclick="subtractRows1()" value="-"></button>
        <table id="workExperienceTable" class="table">
            <tbody id="workExperienceBody">
                {% if form.errors.company_name %}
                <p>{{form.errors.company_name}}</p>
            {% endif %}
            {% if form.errors.designation %}
                        <p>{{form.errors.designation}}</p>
                    {% endif %}
                    {% if form.errors.from1 %}
                    <p>{{form.errors.from1}}</p>
                {% endif %}
                {% if form.errors.to1 %}
                    <p>{{form.errors.to1}}</p>
                {% endif %}
                <tr id="dynamic_row_Experience">
                    <td>
                        <label class="label" for="company_name">Company Name</label>
                        {{form.company_name}}
                        <label class="label" for="designation1">Designation</label>
                        {{form.designation}}
                        <label class="label" for="from1">From</label>
                        {{form.from1}}
                        <label class="label" for="to1">To</label>
                        {{form.to1}}
                    </td>
                </tr>
            </tbody>
        </table>
    </fieldset>
    <button type="submit" name="previous">Previous</button>
        <button type="submit">Next</button>
</div> 

<div class="tab">
    <fieldset>
        <legend>Language Known</legend>
        {{ languageForm.management_form }}
    {% for form in languageForm %}
        {{ form.non_field_errors }}
        <div>
            {{ form.language_known.label_tag }} {{ form.language_known }}
            {% if form.language_known.errors %}
                <ul class="errorlist">
                    {% for error in form.language_known.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.can_read.id_for_label }}">Read</label>
            {{ form.can_read }}
            {% if form.can_read.errors %}
                <ul class="errorlist">
                    {% for error in form.can_read.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.can_write.id_for_label }}">Write</label>
            {{ form.can_write }}
            {% if form.can_write.errors %}
                <ul class="errorlist">
                    {% for error in form.can_write.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.can_speak.id_for_label }}">Speak</label>
            {{ form.can_speak }}
            {% if form.can_speak.errors %}
                <ul class="errorlist">
                    {% for error in form.can_speak.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <hr>
    {% endfor %}
</fieldset>
<button type="submit" name="previous">Previous</button>
<button type="submit">Next</button>
</div>  

<div class="tab">
    <fieldset>
        <legend>
            Technologies You Know
        </legend>
        {{ technologyForm.management_form }}
        {% if technologyForm.errors.technologies_known %}
        {{technologyForm.errors.technologies_known}}
        {%endif%}
        {% if technologyForm.errors.level_of_expertise %}
        {{technologyForm.errors.level_of_expertise}}
        {%endif%}
        <table>
            {% for form in technologyForm %}
            {{ form.non_field_errors }}
             <div>
                <tr>
                    <td>
                        {{ form.technologies_known }}
                        {% if form.technologies_known.errors %}
                        <ul class="errorlist">
                            {% for error in form.technologies_known.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                    </td>
                    <td>
                        {{ form.level_of_expertise }}
                        {% if form.level_of_expertise.errors %}
                        <ul class="errorlist">
                            {% for error in form.level_of_expertise.errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                        {%endif%}
                    </td>
                </tr>
            </div>
            {% endfor %}
        </table>
    </fieldset>
    <button type="submit" name="previous">Previous</button>
        <button type="submit">Next</button>
</div> 


 <div class="tab">
    <fieldset>
        <legend>Reference Table</legend>
        <input type="button" onclick="addReferencerows()" value="+"></button>                  
        <input type="button" onclick="subtractRows2()" value="-"></button>
        <table id="referenceTable" class="table">
            <tbody id="referenceBody">
                {% if referenceForm.errors.name %}
                <p>{{referenceForm.errors.name}}</p>
            {% endif %}
            {% if referenceForm.errors.contact_no %}
                        <p>{{referenceForm.errors.contact_no}}</p>
                    {% endif %}
                    {% if referenceForm.errors.Relation %}
                    <p>{{referenceForm.errors.Relation}}</p>
                {% endif %}
                <tr id="dynamic_row">
                    <td>
                        
                        <label for ="reference_name">Name</label>
                        {{referenceForm.name}}
                        <label for ="contact_no">Contact No</label>
                        {{referenceForm.contact_no}}
                        <label for ="reference_relation">Reference Relation</label>
                        {{referenceForm.Relation}}
                    </td>
                </tr>
            </tbody>
        </table>
        </fieldset>
        <button type="submit" name="previous">Previous</button>
        <button type="submit">Next</button>
</div>  
 
<div class="tab">
           
    <fieldset>
        <legend>Preferance</legend>
        <table style="border: 5;">
            <tr>
                <td rowspan="3">
                    <label for="preferred_location" style="text-align: center; display:block">Preferred location</label>
                    {{preferenceForm.preference_location}}
                </td>
                <td>
                    <label for="notice_period">Notice Period</label>
                    {{preferenceForm.notice_period}}
                </td>
                <td>
                    <p>Department</p>
                    {{preferenceForm.department}}
                </td>
            </tr>
            <tr>
                
                <td><label for="expexted_ctc">Expected CTC</label>
                    {{preferenceForm.expected_ctc}}
                </td>
            </tr>
            <tr>               
                
                <td> <label for = "current_ctc">Current CTC</label>
                    {{preferenceForm.current_ctc}}
                    </td>
                </tr>                
            </table>
        </fieldset>
        <button type="submit" name="previous">Previous</button>
        <button type="submit">Submit</button>
</div>  
{% comment %} <input type="submit" value="submit" id="submitButton" onclick="SubmitForm()">   
 <div style="overflow:auto;">
            
              <button type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
              <button type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
           
          </div> {% endcomment %}
          {% endif %}
</form>
<script>
     var currentTab = 0; // Current tab is set to be the first tab (0)
     showTab(currentTab); // Display the current tab
     function showTab(n) {
            // This function will display the specified tab of the form...
            var x = document.getElementsByClassName("tab");
            x[n].style.display = "block";
            //... and fix the Previous/Next buttons:
            if (n == 0) {
                document.getElementById("prevBtn").style.display = "none";
                document.getElementById("nextBtn").style.display="inline"
            } else {
                document.getElementById("prevBtn").style.display = "inline";
                document.getElementById("nextBtn").style.display="inline"
            }
            if (n == (x.length - 1)) {
                document.getElementById("nextBtn").style.display="none"
                document.getElementById("prevBtn").style.display="inline"
            } else {
                document.getElementById("nextBtn").innerHTML = "Next";
            }
            //... and run a function that will display the correct step indicator:
            fixStepIndicator(n)
            }

            function nextPrev(n) {
            // This function will figure out which tab to display
            var x = document.getElementsByClassName("tab");

            if (n == 1 && !validateForm()) return false;


            // Hide the current tab:
            x[currentTab].style.display = "none";
            currentTab = currentTab + n;
            showTab(currentTab);
            }
            function fixStepIndicator(n) {
            // This function removes the "active" class of all steps...
            var i, x = document.getElementsByClassName("step");
            for (i = 0; i < x.length; i++) {
                x[i].className = x[i].className.replace(" active", "");
            }
            //... and adds the "active" class on the current step:
            x[n].className += " active";
            
            }
            const education_items = document.getElementById("education_body")
        function add_Rows()
        {
        //   console.log("hELLO");
          {% comment %} var row = education_items.insertRow();
          row.setAttribute("id","dynamic_row")
          var cell1=document.createElement('td')
          var label1 = document.createElement('label')
          label1.setAttribute("class","label")
          label1.setAttribute("for","board_name")
          label1.textContent='Name of Board'
          cell1.appendChild(label1)
          var select = document.createElement('select')
          select.setAttribute("id","name_of_board");
          select.setAttribute("name","name_of_board")

        var board_names=['GSEB','CBSC',"Bachelor_Degree","Master_Degree","PHD"]
        board_names.forEach(function(board_name)
        {
            var option = document.createElement('option')
            option.value=board_name;
            option.textContent=board_name;
            select.appendChild(option)
        })
        cell1.appendChild(select)       
 
         
          var label2 = document.createElement('label')
          label2.setAttribute("class","label")
          label2.setAttribute("for","passing_year")
          label2.textContent='Passing Year'
          cell1.appendChild(label2)

          var input2= document.createElement('input')
            input2.setAttribute("id","passing_year")
          input2.setAttribute("name","passing_year")
          input2.setAttribute("class","education")
          input2.setAttribute("type","number")

          cell1.appendChild(input2)

          var label3 = document.createElement('label')
          label3.setAttribute("class","label")
          label3.setAttribute("for","percentage")
          label3.textContent='Percentage'
          cell1.appendChild(label3)

          var input3= document.createElement('input')
          input3.setAttribute("id","percentage")
          input3.setAttribute("name","percentage")
          input3.setAttribute("class","education")
          input3.setAttribute("type","number")

          cell1.appendChild(input3)

          row.appendChild(cell1)         {% endcomment %}

          let educationItem = document.querySelector('#dynamic_row');
          let clonedMenu = educationItem.cloneNode(true);
          clonedMenu.id = 'dynamic_row';
          
          document.getElementById("education_body").appendChild(clonedMenu);
        }
        function subtractRows()
        {
            var table = document.getElementById("education_table");
            var rowCount = table.rows.length;
            
            // Ensure there's at least one row other than the header
            if (rowCount > 1) {
                table.deleteRow(rowCount - 1); // Delete the last row
            }
        }
        const experienceTable = document.getElementById("workExperienceBody")
               
               function experience_addRow()
               {
               //   console.log("hELLO");
                let experienceItem = document.querySelector('#dynamic_row_Experience');
                let clonedMenu = experienceItem.cloneNode(true);
                clonedMenu.id = 'dynamic_row_Experience';
                
                document.getElementById("workExperienceBody").appendChild(clonedMenu);
                
                               
               }
               const reference_items = document.getElementById("referenceBody")
               
               function addReferencerows()
               {
               
                 var row = reference_items.insertRow();
                 row.setAttribute("id","dynamic_row")
                 var cell1=document.createElement('td')
                 var label1 = document.createElement('label')
                 label1.setAttribute("class","label")
                 label1.setAttribute("for","id_name")
                 label1.textContent='Name'
                 cell1.appendChild(label1)
             
               
                 var input= document.createElement('input')
                   input.setAttribute("id","id_name")
                 input.setAttribute("name","name")
                 input.setAttribute("class","reference")
                 input.setAttribute("type","text")
                 cell1.appendChild(input)
                 row.appendChild(cell1)
       
       
       
                
                 var label2 = document.createElement('label')
                 label2.setAttribute("class","label")
                 label2.setAttribute("for","id_contact_no")
                 label2.textContent='Contact No'
                 cell1.appendChild(label2)
       
                 var input2= document.createElement('input')
                   input2.setAttribute("id","id_contact_no")
                 input2.setAttribute("name","contact_no")
                 input2.setAttribute("class","reference")
                 input2.setAttribute("type","text")
       
                 cell1.appendChild(input2)
       
                 var label_31 = document.createElement('label')
                 label_31.setAttribute("class","label")
                 label_31.setAttribute("for","id_Relation")
                 label_31.textContent='Reference Relation'
                 cell1.appendChild(label_31)
       
                 var input_31= document.createElement('input')
                   input_31.setAttribute("id","id_Relation")
                 input_31.setAttribute("name","Relation")
                 input_31.setAttribute("class","reference")
                 input_31.setAttribute("type","text")
       
                 cell1.appendChild(input_31)   
       
                 row.appendChild(cell1)        
                               
               }
        function subtractRows1()
        {
            var table = document.getElementById("workExperienceTable");
            var rowCount = table.rows.length;
            
            // Ensure there's at least one row other than the header
            if (rowCount > 1) {
                table.deleteRow(rowCount - 1); // Delete the last row
            }
        }
        function subtractRows2()
        {
            var table = document.getElementById("referenceTable");
            var rowCount = table.rows.length;
            
            // Ensure there's at least one row other than the header
            if (rowCount > 0) {
                table.deleteRow(rowCount - 1); // Delete the last row
            }
        }
</script>
{% endblock %}